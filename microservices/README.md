# Мікросервісна архітектура Simple Task Manager

## Опис архітектури

Система побудована на основі незалежних мікросервісів, які спілкуються через **API Gateway** та використовують **Service Discovery** для динамічного виявлення адрес сервісів.

## Діаграма взаємодії

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              КЛІЄНТ (Frontend)                               │
│                           http://localhost:8080                              │
└─────────────────────────────────┬───────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        API GATEWAY (порт 8000)                               │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  /api/tasks/*         → Task Service                                │   │
│   │  /api/categories/*    → Category Service                            │   │
│   │  /api/notifications/* → Notification Service                        │   │
│   │  /api/dashboard       → Агрегація з усіх сервісів                   │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────┬───────────────────────────────────────────┘
                                  │
            ┌─────────────────────┼─────────────────────┐
            │                     │                     │
            ▼                     ▼                     ▼
┌───────────────────┐ ┌───────────────────┐ ┌───────────────────┐
│   TASK SERVICE    │ │ CATEGORY SERVICE  │ │NOTIFICATION SERV. │
│    (порт 8001)    │ │    (порт 8002)    │ │    (порт 8003)    │
├───────────────────┤ ├───────────────────┤ ├───────────────────┤
│ • Створення       │ │ • Список категорій│ │ • Перевірка       │
│ • Отримання       │ │ • Створення       │ │   дедлайнів       │
│ • Оновлення статус│ │ • Видалення       │ │ • Нагадування     │
│ • Видалення       │ │ • Статистика      │ │ • Статистика      │
└─────────┬─────────┘ └─────────┬─────────┘ └─────────┬─────────┘
          │                     │                     │
          └─────────────────────┼─────────────────────┘
                                │
                                ▼
                  ┌───────────────────────┐
                  │  SERVICE REGISTRY     │
                  │    (порт 8500)        │
                  ├───────────────────────┤
                  │ • Реєстрація сервісів │
                  │ • Service Discovery   │
                  │ • Health Check        │
                  │ • Heartbeat           │
                  └───────────────────────┘
                                │
                                ▼
                  ┌───────────────────────┐
                  │      MySQL БД         │
                  │  simpletaskmanager    │
                  └───────────────────────┘
```

## Специфікація мікросервісів

### 1. Task Service (Управління завданнями) - порт 8001

| Функція | Endpoint | Вхідні дані (Input) | Вихідні дані (Output) |
|---------|----------|---------------------|----------------------|
| Створення завдання | `POST /tasks` | title, description, priority, due_date, category_id | task_id, статус операції (Success/Error) |
| Отримання завдань | `GET /tasks` | фільтри: status, priority, limit | JSON-список завдань з CategoryName |
| Отримання за ID | `GET /tasks/{id}` | task_id | JSON з даними завдання |
| Оновлення статусу | `PATCH /tasks/{id}/status` | task_id, new_status (Pending/Completed/Overdue) | Оновлений статус, повідомлення |
| Видалення | `DELETE /tasks/{id}` | task_id | Статус операції (Success/Error) |

### 2. Category Service (Управління категоріями) - порт 8002

| Функція | Endpoint | Вхідні дані (Input) | Вихідні дані (Output) |
|---------|----------|---------------------|----------------------|
| Отримання категорій | `GET /categories` | — | JSON-список категорій |
| Створення категорії | `POST /categories` | name, description | category_id, статус операції |
| Отримання за ID | `GET /categories/{id}` | category_id | JSON з даними категорії |
| Видалення | `DELETE /categories/{id}` | category_id | Статус (Error якщо є пов'язані завдання) |
| Кількість завдань | `GET /categories/{id}/tasks/count` | category_id | task_count |

### 3. Notification Service (Сповіщення) - порт 8003

| Функція | Endpoint | Вхідні дані (Input) | Вихідні дані (Output) |
|---------|----------|---------------------|----------------------|
| Перевірка дедлайнів | `GET /deadlines/check` | minutes (інтервал, за замовч. 30) | JSON-список завдань з alert_level (warning/critical/overdue) |
| Аналіз прострочених | `POST /deadlines/analyze` | — | overdue_count, updated_count, список завдань |
| Створення нагадування | `POST /reminders` | task_id, remind_at, message | notification_id, статус |
| Отримання нагадувань | `GET /reminders` | user_id | JSON-список непрочитаних нагадувань |
| Позначити прочитаним | `PATCH /reminders/{id}/sent` | reminder_id | Оновлений статус |
| Статистика | `GET /statistics` | — | by_status, by_priority, overdue_pending |

### 4. Service Registry (Реєстр сервісів) - порт 8500

| Функція | Endpoint | Вхідні дані (Input) | Вихідні дані (Output) |
|---------|----------|---------------------|----------------------|
| Реєстрація | `POST /register` | service_name, host, port, version | service_id, статус |
| Heartbeat | `POST /heartbeat/{id}` | service_id | Статус оновлення |
| Виявлення сервісу | `GET /discover/{name}` | service_name | host, port, url |
| Список сервісів | `GET /services` | — | JSON-список всіх сервісів |
| Видалення | `DELETE /deregister/{id}` | service_id | Статус |

### 5. API Gateway (Єдина точка входу) - порт 8000

| Функція | Endpoint | Маршрутизація |
|---------|----------|---------------|
| Завдання | `/api/tasks/*` | → Task Service (8001) |
| Категорії | `/api/categories/*` | → Category Service (8002) |
| Сповіщення | `/api/notifications/*` | → Notification Service (8003) |
| Дашборд | `/api/dashboard` | Агрегація з усіх сервісів |
| Health | `/health` | Статус всіх сервісів |

## Принципи мікросервісної архітектури

1. **Незалежність** — кожен сервіс можна розробляти, деплоїти та масштабувати окремо
2. **Service Discovery** — сервіси знаходять один одного через Registry, без hardcoded адрес
3. **API Gateway** — єдина точка входу для клієнтів, маршрутизація та агрегація
4. **Heartbeat** — автоматичний моніторинг доступності сервісів
5. **Loose Coupling** — сервіси спілкуються тільки через HTTP API

## Запуск

```bash
# Встановлення залежностей
pip install -r microservices/requirements.txt

# Запуск всіх сервісів (Windows)
start_microservices.bat
```

## Порти

| Сервіс | Порт | Swagger UI |
|--------|------|------------|
| Service Registry | 8500 | http://127.0.0.1:8500/docs |
| API Gateway | 8000 | http://127.0.0.1:8000/docs |
| Task Service | 8001 | http://127.0.0.1:8001/docs |
| Category Service | 8002 | http://127.0.0.1:8002/docs |
| Notification Service | 8003 | http://127.0.0.1:8003/docs |

## Автор

Студент гр. КНТ-22-4 **Малий Д.Д.**  
Практична робота №4 — Сервіс-орієнтована архітектура ПЗ
